# scDDPM: å•ç»†èƒæ‰©æ•£å»å™ªæ¦‚ç‡æ¨¡å‹

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![R](https://img.shields.io/badge/R-4.0+-green.svg)](https://r-project.org)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

> **scDDPM (single-cell Denoising Diffusion Probabilistic Model)** æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆé«˜è´¨é‡å•ç»†èƒRNAæµ‹åºæ•°æ®çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚æœ¬é¡¹ç›®å®ç°äº†å®Œæ•´çš„æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ•°æ®ç”Ÿæˆã€ç”Ÿç‰©å­¦éªŒè¯å’Œè´¨é‡è¯„ä¼°çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### âœ¨ æ ¸å¿ƒç‰¹æ€§
- ğŸ§¬ **é«˜ä¿çœŸå•ç»†èƒæ•°æ®ç”Ÿæˆ**: åŸºäºæ‰©æ•£æ¨¡å‹çš„å…ˆè¿›ç”ŸæˆæŠ€æœ¯
- ğŸ”¬ **å…¨é¢ç”Ÿç‰©å­¦éªŒè¯**: KEGGå¯Œé›†åˆ†æè¾¾åˆ°100%é€šè·¯ä¸€è‡´æ€§
- ğŸš€ **9æ­¥å…¨è‡ªåŠ¨åŒ–æµç¨‹**: ä»æ•°æ®é¢„å¤„ç†åˆ°è´¨é‡è¯„ä¼°çš„å®Œæ•´ç®¡é“
- ğŸ“Š **å¤šæ•°æ®é›†æ”¯æŒ**: æ”¯æŒ5ä¸ªé˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›†å¹¶è¡Œå¤„ç†
- ğŸ—‚ï¸ **æ™ºèƒ½æ–‡ä»¶å½’æ¡£**: æŒ‰æ•°æ®é›†å’ŒåŠŸèƒ½è‡ªåŠ¨åˆ†ç±»å­˜å‚¨ç»“æœ
- ğŸ“ˆ **å®¢è§‚è´¨é‡è¯„ä¼°**: PCAè´¨é‡è¯„ä¼°å’Œè½®å»“ç³»æ•°åˆ†æ

### ğŸŒŸ é¡¹ç›®äº®ç‚¹
- âœ… **ä¸–ç•Œçº§ç”Ÿç‰©å­¦éªŒè¯**: 296ä¸ªKEGGé€šè·¯100%ä¸€è‡´æ€§
- âœ… **æ™ºèƒ½å¢é‡åˆ†æ**: è‡ªåŠ¨è·³è¿‡å·²å®Œæˆæ­¥éª¤ï¼Œæ”¯æŒé€‰æ‹©æ€§é‡è¿è¡Œ
- âœ… **å¤šæ•°æ®é›†æ¶æ„**: ä¸€å¥—ä»£ç å¤„ç†å¤šä¸ªæ•°æ®é›†
- âœ… **ç»“æœå¯é‡ç°**: å®Œæ•´çš„çŠ¶æ€ç®¡ç†å’Œç»“æœç¼“å­˜
- âœ… **ç»¼åˆè´¨é‡è¯„ä¼°**: ä»åˆ†å­åˆ°è¡¨å‹çš„å¤šå±‚æ¬¡éªŒè¯

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ® ä¸€é”®è¿è¡Œå®Œæ•´æµç¨‹

```bash
# é»˜è®¤å¤„ç†AD01103æ•°æ®é›†
./run_complete.sh

# æŒ‡å®šæ•°æ®é›†å¤„ç†
./run_complete.sh --dataset=AD00203

# ç®€çŸ­å½¢å¼
./run_complete.sh -d AD00204

# ç»“åˆå…¶ä»–å‚æ•°
./run_complete.sh -d AD00202 --force-train
```

### ğŸ”§ é«˜çº§å‚æ•°æ§åˆ¶

```bash
# å¼ºåˆ¶é‡æ–°è¿è¡Œé€‰é¡¹
./run_complete.sh --force              # é‡æ–°è¿è¡Œæ‰€æœ‰æ­¥éª¤
./run_complete.sh --force-train        # ä»…é‡æ–°è®­ç»ƒæ¨¡å‹
./run_complete.sh --force-generate     # ä»…é‡æ–°ç”Ÿæˆæ•°æ®
./run_complete.sh --force-kegg         # ä»…é‡æ–°è¿è¡ŒKEGGåˆ†æ
./run_complete.sh --force-pca          # ä»…é‡æ–°è¿è¡ŒPCAè¯„ä¼°

# å¤šæ•°æ®é›†å¤„ç†
./run_complete.sh -d AD00202           # å¤„ç†AD00202æ•°æ®é›†
./run_complete.sh -d AD00203 -f        # å¼ºåˆ¶é‡æ–°å¤„ç†AD00203
```

---

## ğŸ“š æ”¯æŒçš„æ•°æ®é›†

| æ•°æ®é›† | æè¿° | çŠ¶æ€ |
|--------|------|------|
| `AD00202` | é˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›† 202 | âœ… æ”¯æŒ |
| `AD00203` | é˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›† 203 | âœ… æ”¯æŒ |
| `AD00204` | é˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›† 204 | âœ… æ”¯æŒ |
| `AD00401` | é˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›† 401 | âœ… æ”¯æŒ |
| `AD01103` | é˜¿å°”èŒ¨æµ·é»˜ç—…æ•°æ®é›† 1103 | âœ… æ”¯æŒï¼ˆé»˜è®¤ï¼‰ |

---

## ğŸ”„ å®Œæ•´åˆ†ææµç¨‹

### ğŸ“‹ 9æ­¥è‡ªåŠ¨åŒ–æµç¨‹æ¦‚è§ˆ

| æ­¥éª¤ | åŠŸèƒ½ | è¾“å…¥ | è¾“å‡º | çŠ¶æ€æ£€æŸ¥ |
|------|------|------|------|----------|
| **1/9** | æ•°æ®è§£å‹ | å‹ç¼©æ•°æ®æ–‡ä»¶ | è§£å‹åçš„åŸå§‹æ•°æ® | æ™ºèƒ½è·³è¿‡ |
| **2/9** | ç›®å½•åˆ›å»º | - | `FD1000/`, `output/` | è‡ªåŠ¨åˆ›å»º |
| **3/9** | é…ç½®æ˜¾ç¤º | `config.py` | ç³»ç»Ÿé…ç½®ä¿¡æ¯ | å®æ—¶æ£€æŸ¥ |
| **4/9** | è·¯å¾„éªŒè¯ | `test_paths.py` | è·¯å¾„å®Œæ•´æ€§æŠ¥å‘Š | ä¾èµ–æ£€æŸ¥ |
| **5/9** | æ•°æ®é¢„å¤„ç† | åŸå§‹æ•°æ® | æ ‡å‡†åŒ–è¡¨è¾¾çŸ©é˜µ | å¢é‡æ‰§è¡Œ |
| **6/9** | æ¨¡å‹è®­ç»ƒ | é¢„å¤„ç†æ•°æ® | è®­ç»ƒå¥½çš„æ¨¡å‹ | æ™ºèƒ½è·³è¿‡ |
| **7/9** | æ•°æ®ç”Ÿæˆ | è®­ç»ƒæ¨¡å‹ | ç”Ÿæˆçš„å•ç»†èƒæ•°æ® | ç¼“å­˜ç®¡ç† |
| **8/9** | ä¸‹æ¸¸åˆ†æ | ç”Ÿæˆæ•°æ® | èšç±»ã€å¯è§†åŒ–ã€å·®å¼‚åˆ†æ | åˆ†æ¨¡å—æ‰§è¡Œ |
| **9/9** | KEGGå¯Œé›†åˆ†æ | çœŸå®+ç”Ÿæˆæ•°æ® | ç”Ÿç‰©å­¦é€šè·¯éªŒè¯ | ç»“æœæŒä¹…åŒ– |
| **10/9** | PCAè´¨é‡è¯„ä¼° | çœŸå®+ç”Ÿæˆæ•°æ® | å®¢è§‚è´¨é‡æŒ‡æ ‡ | æ–°å¢åŠŸèƒ½ |

### ğŸ—ï¸ è¯¦ç»†æµç¨‹è¯´æ˜

#### [æ­¥éª¤ 1/9] æ™ºèƒ½æ•°æ®è§£å‹
```bash
# è‡ªåŠ¨æ£€æµ‹å¹¶è§£å‹å„ç§æ ¼å¼
ğŸ“¦ æ”¯æŒæ ¼å¼: .gz, .tar.gz, .rar
ğŸ” æ™ºèƒ½æ£€æµ‹: åªè§£å‹ç¼ºå¤±æ–‡ä»¶
âœ… æ•°æ®é›†: ADç³»åˆ—ã€10X PBMC 3kã€Baronã€GSE119911
```

#### [æ­¥éª¤ 2/9] ç¯å¢ƒå‡†å¤‡
- **è‡ªåŠ¨åˆ›å»º**: é¢„å¤„ç†å’Œè¾“å‡ºç›®å½•
- **çŠ¶æ€æ£€æŸ¥**: éªŒè¯ç¯å¢ƒé…ç½®

#### [æ­¥éª¤ 3/9] é…ç½®éªŒè¯
```python
python config.py      # æ˜¾ç¤ºå½“å‰æ•°æ®é›†é…ç½®
```

#### [æ­¥éª¤ 4/9] è·¯å¾„å®Œæ•´æ€§æ£€æŸ¥
```python
python test_paths.py  # éªŒè¯æ‰€æœ‰å¿…éœ€è·¯å¾„
```

#### [æ­¥éª¤ 5/9] æ•°æ®é¢„å¤„ç†
```r
Rscript code/Preprocess.R
```
- **è¾“å…¥**: `data/{DATASET}/` åŸå§‹æ•°æ®
- **è¾“å‡º**: `FD1000/{DATASET}PreProLabel1000.csv`
- **åŠŸèƒ½**: æ ‡å‡†åŒ–ã€è¿‡æ»¤ã€è´¨é‡æ§åˆ¶

#### [æ­¥éª¤ 6/9] æ¨¡å‹è®­ç»ƒ
```python
python code/train_model.py
```
- **ç®—æ³•**: scDDPMæ‰©æ•£å»å™ªæ¦‚ç‡æ¨¡å‹
- **è¾“å‡º**: `models/{DATASET}_*_best_*.pth`
- **ç‰¹ç‚¹**: æ”¯æŒå¤šç»†èƒç±»å‹å¹¶è¡Œè®­ç»ƒ

#### [æ­¥éª¤ 7/9] æ•°æ®ç”Ÿæˆ
```python
python code/generate_data.py
```
- **è¾“å…¥**: è®­ç»ƒæ¨¡å‹ + é¢„å¤„ç†æ•°æ®
- **è¾“å‡º**: `output/{DATASET}/generated_data/{DATASET}_generated.csv`
- **è´¨é‡**: é«˜ä¿çœŸåº¦ï¼Œä¿æŒç”Ÿç‰©å­¦ç‰¹å¾

#### [æ­¥éª¤ 8/9] ä¸‹æ¸¸åˆ†æ
##### 8.1 èšç±»åˆ†æ
```r
Rscript code/sc3cluster.R
```
- **è¾“å‡º**: `output/{DATASET}/clustering/sc3_clustering_labels.csv`

##### 8.2 å¯è§†åŒ–åˆ†æ
```r
Rscript code/Classification\ visualization.R
```
- **è¾“å‡º**: `output/{DATASET}/visualization/*_pca*.pdf`

##### 8.3 å·®å¼‚è¡¨è¾¾åˆ†æ
```r
Rscript code/differential\ gene\ expression.R
```
- **è¾“å‡º**: `output/{DATASET}/differential_expression/`

#### [æ­¥éª¤ 9/9] KEGGå¯Œé›†åˆ†æ ğŸŒŸ
```r
Rscript code/kegg.R                    # åŸºç¡€åˆ†æ
Rscript code/kegg_detailed_analysis.R  # è¯¦ç»†æ¯”è¾ƒ
```
- **è¾“å‡º**: `output/{DATASET}/kegg_analysis/`
- **äº®ç‚¹**: 296ä¸ªå…±åŒKEGGé€šè·¯ï¼ˆ100%ä¸€è‡´æ€§ï¼‰

#### [æ­¥éª¤ 10/9] PCAè´¨é‡è¯„ä¼° â­ æ–°åŠŸèƒ½
```r
Rscript code/pca_quality_assessment.R
```
- **åŠŸèƒ½**: å®¢è§‚æ•°å­—åŒ–è´¨é‡è¯„ä¼°
- **æŒ‡æ ‡**: è½®å»“ç³»æ•°ã€åˆ†å¸ƒç›¸ä¼¼æ€§ã€é‡å åº¦åˆ†æ
- **è¾“å‡º**: `output/{DATASET}/quality_assessment/pca_quality_assessment.csv`

---

## ğŸ—‚ï¸ æ™ºèƒ½æ–‡ä»¶å½’æ¡£ç³»ç»Ÿ

### ğŸ“ è‡ªåŠ¨ç›®å½•ç»“æ„

æ¯ä¸ªæ•°æ®é›†çš„ç»“æœä¼šè‡ªåŠ¨ä¿å­˜åˆ°ç‹¬ç«‹ä¸”åˆ†ç±»çš„ç›®å½•ä¸­ï¼š

```
output/
â”œâ”€â”€ AD00202/                          # æ•°æ®é›†ç‹¬ç«‹ç›®å½•
â”‚   â”œâ”€â”€ generated_data/               # ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ AD00202_generated.csv
â”‚   â”œâ”€â”€ visualization/                # PCAã€t-SNEç­‰å¯è§†åŒ–
â”‚   â”‚   â”œâ”€â”€ real_data_pca.pdf
â”‚   â”‚   â”œâ”€â”€ generated_data_pca.pdf
â”‚   â”‚   â””â”€â”€ combined_data_pca.pdf
â”‚   â”œâ”€â”€ clustering/                   # èšç±»åˆ†æç»“æœ
â”‚   â”‚   â””â”€â”€ sc3_clustering_labels.csv
â”‚   â”œâ”€â”€ differential_expression/      # å·®å¼‚è¡¨è¾¾åˆ†æ
â”‚   â”‚   â”œâ”€â”€ real_top100_genes.csv
â”‚   â”‚   â””â”€â”€ generated_top100_genes.csv
â”‚   â”œâ”€â”€ kegg_analysis/               # KEGGå¯Œé›†åˆ†æ
â”‚   â”‚   â”œâ”€â”€ kegg_real_results.rds
â”‚   â”‚   â”œâ”€â”€ kegg_generated_results.rds
â”‚   â”‚   â”œâ”€â”€ KEGG_comparison_and_venn.pdf
â”‚   â”‚   â””â”€â”€ detailed_kegg_comparison.pdf
â”‚   â”œâ”€â”€ quality_assessment/          # è´¨é‡è¯„ä¼°ç»“æœ
â”‚   â”‚   â””â”€â”€ pca_quality_assessment.csv
â”‚   â””â”€â”€ reports/                     # åˆ†ææŠ¥å‘Š
â”œâ”€â”€ AD00203/                         # å…¶ä»–æ•°æ®é›†åŒæ ·ç»“æ„
â””â”€â”€ ...
```

### ğŸ¯ å½’æ¡£ç‰¹æ€§

- **è‡ªåŠ¨åˆ†ç±»**: æŒ‰åŠŸèƒ½å’Œæ•°æ®é›†åŒé‡åˆ†ç±»
- **å¢é‡åˆ›å»º**: è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºå¿…è¦ç›®å½•
- **ç»“æœéš”ç¦»**: ä¸åŒæ•°æ®é›†ç»“æœå®Œå…¨ç‹¬ç«‹
- **è·¯å¾„æ™ºèƒ½**: è‡ªåŠ¨è§£ææ­£ç¡®çš„è¾“å…¥è¾“å‡ºè·¯å¾„

---

## ğŸ“Š å…³é”®ç»“æœå±•ç¤º

### ğŸ† æ•°æ®ç”Ÿæˆè´¨é‡è¯„ä¼°

#### ğŸ§¬ ç”Ÿç‰©å­¦åŠŸèƒ½å±‚é¢ï¼ˆä¸–ç•Œçº§æ°´å¹³ï¼‰
| æŒ‡æ ‡ | ç»“æœ | è¯„ä»· |
|------|------|------|
| **KEGGé€šè·¯ä¸€è‡´æ€§** | **100%** | ğŸŒŸ ä¸–ç•Œçº§ |
| **å…±åŒé€šè·¯æ•°é‡** | **296ä¸ª** | ğŸŒŸ å®Œå…¨è¦†ç›– |
| **ç¥ç»ç³»ç»Ÿé€šè·¯** | **15ä¸ªå®Œæ•´ä¿æŒ** | ğŸŒŸ åŠŸèƒ½å®Œæ•´ |
| **åŸºå› æ˜ å°„æˆåŠŸç‡** | **92.6%** (926/1000) | ğŸŒŸ ä¼˜ç§€ |
| **å¯Œé›†å¼ºåº¦å·®å¼‚** | **0.00** | ğŸŒŸ å®Œå…¨ä¸€è‡´ |

#### ğŸ“ˆ ç»†èƒè¡¨å‹å±‚é¢ï¼ˆä¸­ç­‰æ°´å¹³ï¼‰
| æŒ‡æ ‡ | çœŸå®æ•°æ® | ç”Ÿæˆæ•°æ® | åˆå¹¶æ•°æ® | è¯„ä»· |
|------|----------|----------|----------|------|
| **è½®å»“ç³»æ•°** | -0.005 | 0.785 | 0.616 | âš ï¸ ä¸­ç­‰ |
| **PCAæ–¹å·®è§£é‡Š** | 9.1% | 10.9% | 10.1% | âœ… æ­£å¸¸ |
| **æ•°æ®é‡å åº¦** | - | - | 68.9% | âš ï¸ ä¸€èˆ¬ |
| **æ€»ä½“è´¨é‡å¾—åˆ†** | - | - | **0.50/1.0** | âš ï¸ ä¸­ç­‰ |

### ğŸ”¬ ç”Ÿç‰©å­¦éªŒè¯äº®ç‚¹

- **ç»†èƒç±»å‹**: Astrocytesã€Excitatory neuronsã€Inhibitory neurons
- **é€šè·¯ä¿æŒ**: ç¥ç»é€€è¡Œæ€§ç–¾ç—…ã€æ°§åŒ–ç£·é…¸åŒ–ã€æœŠç—…æ¯’ç–¾ç—…ç­‰å…³é”®é€šè·¯
- **ä»£è°¢ç½‘ç»œ**: æ ¸å¿ƒä»£è°¢é€šè·¯å®Œæ•´æ€§100%ä¿æŒ
- **ä¿¡å·ä¼ å¯¼**: é‡è¦ç»†èƒé€šè®¯æœºåˆ¶åŠŸèƒ½å®Œæ•´

---

## ğŸ› ï¸ ç¯å¢ƒé…ç½®

### ğŸ Pythonç¯å¢ƒ
```bash
# æ¨èPython 3.8+
pip install torch>=1.9.0
pip install numpy>=1.20.0
pip install pandas>=1.3.0
pip install scikit-learn>=0.24.0
pip install matplotlib>=3.3.0
pip install seaborn>=0.11.0
```

### ğŸ“Š Rç¯å¢ƒ
```r
# æ¨èR 4.0+
# BioconductoråŒ…
BiocManager::install("clusterProfiler")
BiocManager::install("org.Hs.eg.db") 
BiocManager::install("scater")
BiocManager::install("SC3")
BiocManager::install("SingleCellExperiment")

# CRANåŒ…
install.packages(c("ggplot2", "dplyr", "VennDiagram", "enrichplot"))
```

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### ğŸ’¾ KEGGç»“æœç®¡ç†ç³»ç»Ÿ
```r
# åœ¨Rç¯å¢ƒä¸­ä½¿ç”¨
source("code/load_kegg_results.R")

# æ™ºèƒ½ç®¡ç†å‘½ä»¤
check_kegg_status()                   # æ£€æŸ¥åˆ†æçŠ¶æ€
load_kegg_results()                   # ä»æ–‡ä»¶åŠ è½½ç»“æœ
clear_kegg_results()                  # æ¸…ç†å†…å­˜å’Œæ–‡ä»¶
```

### ğŸ›ï¸ å•ç‹¬è¿è¡Œç‰¹å®šåˆ†æ
```bash
# ä½¿ç”¨ç¯å¢ƒå˜é‡æŒ‡å®šæ•°æ®é›†
DATASET_NAME=AD00203 Rscript code/pca_quality_assessment.R
DATASET_NAME=AD00204 python code/generate_data.py
DATASET_NAME=AD00202 Rscript code/kegg.R
```

### ğŸ“Š çŠ¶æ€ç›‘æ§å’ŒéªŒè¯
```bash
# æ£€æŸ¥å„æ­¥éª¤å®ŒæˆçŠ¶æ€
ls -la FD1000/                       # é¢„å¤„ç†ç»“æœ
ls -la models/                       # è®­ç»ƒæ¨¡å‹
ls -la output/*/                     # å„æ•°æ®é›†ç»“æœ
find output/ -name "*.csv" | wc -l   # ç»“æœæ–‡ä»¶ç»Ÿè®¡
```

---

## ğŸ“‹ é¡¹ç›®æ¶æ„

```
scDDPM/
â”œâ”€â”€ ğŸ”§ æ ¸å¿ƒä»£ç /
â”‚   â”œâ”€â”€ code/
â”‚   â”‚   â”œâ”€â”€ create_output_structure.R         # ğŸ†• ç›®å½•ç»“æ„ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ Preprocess.R                      # æ•°æ®é¢„å¤„ç†
â”‚   â”‚   â”œâ”€â”€ train_model.py                    # æ¨¡å‹è®­ç»ƒ
â”‚   â”‚   â”œâ”€â”€ generate_data.py                  # æ•°æ®ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ scDDPM.py                        # æ‰©æ•£æ¨¡å‹å®ç°
â”‚   â”‚   â”œâ”€â”€ sc3cluster.R                     # SC3èšç±»åˆ†æ
â”‚   â”‚   â”œâ”€â”€ Classification\ visualization.R   # å¯è§†åŒ–åˆ†æ
â”‚   â”‚   â”œâ”€â”€ differential\ gene\ expression.R # å·®å¼‚è¡¨è¾¾åˆ†æ
â”‚   â”‚   â”œâ”€â”€ kegg.R                           # KEGGåŸºç¡€åˆ†æ
â”‚   â”‚   â”œâ”€â”€ kegg_detailed_analysis.R         # KEGGè¯¦ç»†åˆ†æ
â”‚   â”‚   â”œâ”€â”€ load_kegg_results.R              # KEGGç»“æœç®¡ç†
â”‚   â”‚   â””â”€â”€ pca_quality_assessment.R         # ğŸ†• PCAè´¨é‡è¯„ä¼°
â”‚   â”œâ”€â”€ config.py                            # ğŸ†• å¤šæ•°æ®é›†é…ç½®
â”‚   â””â”€â”€ test_paths.py                        # è·¯å¾„éªŒè¯å·¥å…·
â”œâ”€â”€ ğŸ“Š è¾“å…¥æ•°æ®/
â”‚   â””â”€â”€ data/                                # å¤šæ•°æ®é›†åŸå§‹æ•°æ®
â”‚       â”œâ”€â”€ AD00202/
â”‚       â”œâ”€â”€ AD00203/
â”‚       â”œâ”€â”€ AD00204/
â”‚       â”œâ”€â”€ AD00401/
â”‚       â””â”€â”€ AD01103/
â”œâ”€â”€ ğŸ“ˆ è¾“å‡ºç»“æœ/
â”‚   â”œâ”€â”€ FD1000/                             # é¢„å¤„ç†æ•°æ®
â”‚   â”œâ”€â”€ models/                             # è®­ç»ƒæ¨¡å‹
â”‚   â””â”€â”€ output/                             # ğŸ†• æŒ‰æ•°æ®é›†åˆ†ç±»çš„ç»“æœ
â”‚       â”œâ”€â”€ AD00202/
â”‚       â”œâ”€â”€ AD00203/
â”‚       â””â”€â”€ ...
â”œâ”€â”€ ğŸš€ è‡ªåŠ¨åŒ–è„šæœ¬/
â”‚   â””â”€â”€ run_complete.sh                     # ğŸ†• å¤šæ•°æ®é›†ä¸»æ‰§è¡Œè„šæœ¬
â”œâ”€â”€ ğŸ“š æ–‡æ¡£/
â”‚   â”œâ”€â”€ README.md                           # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â””â”€â”€ MULTI_DATASET_USAGE.md             # ğŸ†• å¤šæ•°æ®é›†ä½¿ç”¨æŒ‡å—
â””â”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶/
    â””â”€â”€ config.py                          # ç»Ÿä¸€é…ç½®ç®¡ç†
```

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: å¤„ç†æ–°çš„æ•°æ®é›†
```bash
# 1. å¤„ç†AD00203æ•°æ®é›†
./run_complete.sh --dataset=AD00203

# 2. æŸ¥çœ‹ç»“æœ
ls -la output/AD00203/*/

# 3. æ¯”è¾ƒä¸åŒæ•°æ®é›†ç»“æœ
diff output/AD01103/kegg_analysis/kegg_summary_statistics.csv \
     output/AD00203/kegg_analysis/kegg_summary_statistics.csv
```

### ç¤ºä¾‹2: é‡æ–°è®­ç»ƒç‰¹å®šæ•°æ®é›†
```bash
# ä»…é‡æ–°è®­ç»ƒAD00204çš„æ¨¡å‹
./run_complete.sh -d AD00204 --force-train

# æ£€æŸ¥æ–°ç”Ÿæˆçš„æ¨¡å‹
ls -la models/AD00204*
```

### ç¤ºä¾‹3: æ‰¹é‡å¤„ç†å¤šä¸ªæ•°æ®é›†
```bash
# ä¸²è¡Œå¤„ç†å¤šä¸ªæ•°æ®é›†
for dataset in AD00202 AD00203 AD00204; do
    echo "Processing $dataset..."
    ./run_complete.sh -d $dataset
done
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### âš¡ è¿è¡Œæ—¶é—´ï¼ˆåŸºäºM3-MAXï¼‰
- **æ•°æ®é¢„å¤„ç†**: ~2-5åˆ†é’Ÿ
- **æ¨¡å‹è®­ç»ƒ**: ~30-60åˆ†é’Ÿï¼ˆå–å†³äºæ•°æ®é›†å¤§å°ï¼‰
- **æ•°æ®ç”Ÿæˆ**: ~5-10åˆ†é’Ÿ
- **ä¸‹æ¸¸åˆ†æ**: ~10-15åˆ†é’Ÿ
- **KEGGåˆ†æ**: ~5-8åˆ†é’Ÿ
- **æ€»è®¡**: ~50-100åˆ†é’Ÿ/æ•°æ®é›†

### ğŸ’¾ å­˜å‚¨éœ€æ±‚
- **åŸå§‹æ•°æ®**: ~100MB-1GB/æ•°æ®é›†
- **é¢„å¤„ç†æ•°æ®**: ~10-50MB/æ•°æ®é›†
- **è®­ç»ƒæ¨¡å‹**: ~1-10MB/ç»†èƒç±»å‹
- **ç”Ÿæˆæ•°æ®**: ~50-200MB/æ•°æ®é›†
- **åˆ†æç»“æœ**: ~10-30MB/æ•°æ®é›†

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **Fork** æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ **Pull Request**

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®é“¾æ¥**: [https://github.com/your-username/scDDPM](https://github.com/your-username/scDDPM)
- **é—®é¢˜æŠ¥å‘Š**: [Issues](https://github.com/your-username/scDDPM/issues)

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºå•ç»†èƒåˆ†æå’Œæ‰©æ•£æ¨¡å‹é¢†åŸŸåšå‡ºè´¡çŒ®çš„ç ”ç©¶è€…å’Œå¼€å‘è€…ã€‚

---

*æœ€åæ›´æ–°: 2024å¹´7æœˆ*